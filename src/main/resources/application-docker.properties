################################################################################
# EjercicioCopilot - Spring Boot Configuration for Docker
################################################################################
#
# Perfil específico para ejecución en Docker (spring.profiles.active=docker)
# Configuración optimizada para contenedores.
#

################################################################################
# SERVIDOR
################################################################################

# Puerto en el que escucha la aplicación
server.port=8080

# Contexto raíz de la aplicación
server.servlet.context-path=/

# Charset por defecto
server.servlet.encoding.charset=UTF-8
server.servlet.encoding.enabled=true
server.servlet.encoding.force=true

# Compresión de respuestas HTTP
server.compression.enabled=true
server.compression.min-response-size=1024

# Graceful shutdown (permite que transacciones terminen)
server.shutdown=graceful
spring.lifecycle.timeout-per-shutdown-phase=30s

################################################################################
# BASE DE DATOS - H2 (En Memoria)
################################################################################
#
# Por defecto, H2 en memoria (se pierde al reiniciar)
# Para persistencia, cambiar a: jdbc:h2:file:./data/h2db
#

# Driver y URL
spring.datasource.url=jdbc:h2:mem:testdb
spring.datasource.driver-class-name=org.h2.Driver

# Credenciales
spring.datasource.username=sa
spring.datasource.password=

# Pool de conexiones
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.connection-timeout=20000
spring.datasource.hikari.idle-timeout=300000

################################################################################
# H2 CONSOLE (Solo para desarrollo/debugging)
################################################################################
#
# Accesible en: http://localhost:8080/h2-console
# JDBC URL: jdbc:h2:mem:testdb
# User: sa
# Password: (vacía)
#

spring.h2.console.enabled=true
spring.h2.console.path=/h2-console
spring.h2.console.settings.trace=false
spring.h2.console.settings.web-allow-others=false

################################################################################
# JPA / HIBERNATE
################################################################################

# Dialecto para H2
spring.jpa.database-platform=org.hibernate.dialect.H2Dialect

# DDL auto - Crear/Drop tablas al iniciar/terminar
spring.jpa.hibernate.ddl-auto=create-drop

# Mostrar SQL en logs (desactivado en producción)
spring.jpa.show-sql=false

# Formatear SQL para logs (solo si show-sql=true)
spring.jpa.properties.hibernate.format_sql=true

# Dialect específico para Hibernate
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.H2Dialect

# Propiedades adicionales de Hibernate
spring.jpa.properties.hibernate.jdbc.batch_size=20
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true

# Lazy loading en línea de logs
spring.jpa.open-in-view=false

################################################################################
# LOGGING
################################################################################

# Configuración global de logging
logging.level.root=INFO

# Logging específico por paquete
logging.level.com.ejerciciocopilot=DEBUG
logging.level.com.ejerciciocopilot.controller=DEBUG
logging.level.com.ejerciciocopilot.service=DEBUG
logging.level.com.ejerciciocopilot.repository=DEBUG

# Logging de Spring
logging.level.org.springframework.web=INFO
logging.level.org.springframework.boot=INFO
logging.level.org.springframework.data=INFO

# Logging de Hibernate
logging.level.org.hibernate=WARN
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE

# Patrón de log en consola
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n

# Archivo de log (opcional)
# logging.file.name=/app/logs/aplicacion.log
# logging.file.max-size=10MB
# logging.file.max-history=10

################################################################################
# SPRING BOOT ACTUATOR
################################################################################
#
# Endpoints de monitoreo y métricas
# Accesibles en: http://localhost:8080/actuator
#

# Endpoints expuestos (solo los necesarios)
management.endpoints.web.exposure.include=health,info,metrics,env

# Health check detallado
management.endpoint.health.show-details=always
management.endpoint.health.probes.enabled=true

# Metrics
management.metrics.enable.jvm=true
management.metrics.enable.process=true
management.metrics.enable.system=true

# Livenessstate y readinessstate
management.health.livenessState.enabled=true
management.health.readinessState.enabled=true

# Información de la aplicación
management.info.defaults.enabled=true

################################################################################
# APLICACIÓN ESPECÍFICA
################################################################################

# Nombre y versión de la aplicación
spring.application.name=EjercicioCopilot
app.version=1.0.0
app.description=Generador de Excusas Tech

################################################################################
# JACKSON - Serialización JSON
################################################################################

# Incluir propiedades no nulas en respuestas
spring.jackson.default-property-inclusion=non_null

# Timezone para fechas
spring.jackson.time-zone=UTC
spring.jackson.serialization.write-dates-as-timestamps=false

# Indentación de JSON (solo en desarrollo)
spring.jackson.serialization.indent-output=false

################################################################################
# VALIDACIÓN
################################################################################

# Validación de Jakarta Bean Validation
spring.validation.enabled=true

################################################################################
# SEGURIDAD (Opcional para futura expansión)
################################################################################

# CORS (descomentado si se necesita)
# spring.web.cors.allowed-origins=*
# spring.web.cors.allowed-methods=GET,POST,PUT,DELETE,PATCH
# spring.web.cors.allowed-headers=*
# spring.web.cors.allow-credentials=true
# spring.web.cors.max-age=3600

################################################################################
# NOTAS
################################################################################
#
# Este perfil está optimizado para Docker. Características:
#
# ✓ H2 en memoria (fast para desarrollo/testing)
# ✓ Logging detallado para debugging
# ✓ Actuator habilitado para monitoring
# ✓ H2 Console para inspeccionar BD
# ✓ Graceful shutdown para transacciones
# ✓ Pool de conexiones configurado
# ✓ JSON sin campos nulos (respuestas limpias)
#
# Variables de entorno para override (en docker-compose.yml):
#   SPRING_DATASOURCE_URL
#   SPRING_JPA_HIBERNATE_DDL_AUTO
#   LOGGING_LEVEL_ROOT
#   LOGGING_LEVEL_COM_EJERCICIOCOPILOT
#   MANAGEMENT_ENDPOINTS_WEB_EXPOSURE_INCLUDE
#
################################################################################
